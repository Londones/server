name: Create .env for deployment

on:
  push:
    branches: ["deployment"]
  pull_request:
    branches: ["deployment"]

jobs:
  create-env:
    name: Create env file
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Generate env file
        uses: ozaytsev86/create-env-file@v1
        with:
          INPUT_ENV_APP_ENV: ${{ secrets.APP_ENV }}
          INPUT_ENV_APP_SECRET: ${{ secrets.APP_SECRET }}
          INPUT_ENV_MESSENGER_TRANSPORT_DSN: ${{ secrets.MESSENGER_TRANSPORT_DSN }}
          INPUT_ENV_CORS_ALLOW_ORIGIN: ${{ secrets.CORS_ALLOW_ORIGIN }}
          INPUT_ENV_ADMIN_PASSWORD: ${{ secrets.ADMIN_PASSWORD }}
          INPUT_ENV_JWT_SECRET_KEY: ${{ secrets.JWT_SECRET_KEY }}
          INPUT_ENV_JWT_PUBLIC_KEY: ${{ secrets.JWT_PUBLIC_KEY }}
          INPUT_ENV_JWT_PASSPHRASE: ${{ secrets.JWT_PASSPHRASE }}
          INPUT_ENV_DATABASE_URL: ${{ secrets.DATABASE_URL }}

      - run: sudo chown -R $(id -u):$(id -g) .env
